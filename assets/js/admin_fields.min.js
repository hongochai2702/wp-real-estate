jQuery(function(e){"use strict";var t=e(document),a="";e("#widgets-right").length?a="#widgets-right ":0==e("#menu-to-edit").length&&(document.getElementsByClassName("tpfw-repeater").length&&e(".tpfw-repeater").tpfwRepeater(),document.getElementsByClassName("tpfw-map").length&&e(".tpfw-map").tpfwMap()),document.getElementsByClassName("tpfw-image_picker").length&&e(".tpfw-image_picker").tpfwImagePicker(),document.getElementsByClassName("tpfw-link").length&&e(".tpfw-link").tpfwLink(),e(".tpfw-color:not(.child-field)").length&&e(a+".tpfw-color:not(.child-field)").wpColorPicker(),e(a+".tpfw-icon_picker:not(.child-field)").length&&e(a+".tpfw-icon_picker:not(.child-field) select").fontIconPicker(),document.getElementsByClassName("tpfw-datetime").length&&e(a+".tpfw-datetime input").each(function(){var t=e(this).data();e(this).datetimepicker(t)}),document.getElementsByClassName("tpfw-checkboxes")&&t.on("change",'.tpfw-checkboxes input[type="checkbox"]',function(){var t=e(this).closest("ul").find('input[type="checkbox"]:checked').map(function(){return this.value}).get().join(",");e(this).closest("ul").prev("input.tpfw_value").val(t).trigger("change")}),document.getElementsByClassName("tpfw-radios")&&t.on("change",'.tpfw-radios input[type="radio"]',function(){var t=e(this),a=t.closest("ul");a.find("input").removeAttr("checked"),t.attr("checked","checked"),a.prev("input.tpfw_value").val(t.val()).trigger("change")}),document.getElementsByClassName("tpfw-upload")&&e(".tpfw-upload").tpfwUpload(),e(a+".tpfw-select-multiple").length&&(e(a+".tpfw-select-multiple:not(.child-field)").selectize({plugins:["remove_button","drag_drop"]}),t.on("change",a+".tpfw-select-multiple",function(){e(this).closest("div").find(".tpfw_value").val(e(this).val()).trigger("change")})),e(a+".tpfw-autocomplete select").length&&(e(a+".tpfw-autocomplete:not(.child-field) select").tpfwAutocomplete(),t.on("change",a+".tpfw-autocomplete select",function(){e(this).closest("div").find(".tpfw_value").val(e(this).val()).trigger("change")}));var n=function(t){if(window.hasOwnProperty("google")){var a=t.find(".tpfw-map");a.length&&a.tpfwMap().addClass("map_loaded")}var n=t.find(".tpfw-color");n.length&&n.wpColorPicker();var i=t.find(".tpfw-icon_picker select");i.length&&i.fontIconPicker();var p=t.find(".tpfw-datetime input");p.length&&p.each(function(){var t=e(this).data();e(this).datetimepicker(t)});var l=t.find(".tpfw-repeater");l.length&&!l.hasClass("repeater_loaded")&&l.addClass("repeater_loaded").tpfwRepeater(),t.find(".tpfw-select-multiple").length&&t.find(".tpfw-select-multiple:not(.child-field)").selectize({plugins:["remove_button","drag_drop"]}),t.find(".tpfw-autocomplete").length&&t.find(".tpfw-autocomplete:not(.child-field) select").tpfwAutocomplete();var o=t.find("div[data-dependency]");o.length&&o.initWidgetDependency()};if(t.on("widget-updated",function(e,t){n(t)}),t.on("widget-added",function(e,t){n(t)}),t.on("click","#widgets-right .widget-title",function(t){var a=e(this);setTimeout(function(){var e=a.closest(".open");if(e.length){var t=e.find(".tpfw-map");t.length&&!t.hasClass("map_loaded")&&t.tpfwMap();var n=e.find(".tpfw-repeater");n.length&&!n.hasClass("repeater_loaded")&&n.addClass("repeater_loaded").tpfwRepeater()}},300),t.preventDefault()}),t.on("tpfw-repeater-item-opened",function(e,t){var a=t.find(".tpfw-map");a.length&&a.tpfwMap()}),t.on("click",".tpfw_group .group_nav a",function(a){var n=e(this),i=n.attr("href");n.closest("ul").find(".active").removeClass("active"),n.addClass("active"),e(".tpfw_group .group_item.active").removeClass("active");var p=e(".tpfw_group "+i);p.addClass("active"),e(".tpfw_group "+i+" .map_loaded").length&&(p.find(".tpfw-map").hasClass("map_refresh")||p.find(".tpfw-map").tpfwMap().addClass("map_refresh")),t.trigger("tpfw_group_active",[p]),a.preventDefault()}),e("#menu-to-edit .menu-item .item-edit").click(function(t){var a=e(this);setTimeout(function(){var e=a.closest(".menu-item");if(e.length){var t=e.find(".tpfw-map");t.length&&!t.hasClass("map_loaded")&&t.tpfwMap()}},300),t.preventDefault()}),window.hasOwnProperty("pagenow"))if("widgets"===pagenow){var i=e("#widgets-right").find("div[data-dependency]");i.length&&i.initWidgetDependency()}else"nav-menus"===pagenow?e("#menu-to-edit div[data-dependency]").length&&e("#menu-to-edit div[data-dependency]").initMenuDependency():e("[data-dependency]").initDependency();else e("[data-dependency]").length&&e("[data-dependency]").initDependency();e("input.tpfw-manage_box").length&&(e("input.tpfw-manage_box").each(function(){var t=e(this),a="";1==t.val()?(a="checked",t.closest(".postbox").removeClass("postbox--disabled")):t.closest(".postbox").addClass("postbox--disabled"),t.closest(".postbox").find(".hndle").before('<label class="tpfw-controlbox"><input type="checkbox" '+a+' data-name="'+t.attr("name")+'"/>'+t.data("label")+"</label>")}),e(document).on("change",".tpfw-controlbox input",function(t){var a=e(this),n=a.closest(".postbox"),i=0;a.is(":checked")?(n.removeClass("postbox--disabled"),i=1):n.addClass("postbox--disabled"),e("input[name="+a.data("name")+"]").val(i).change(),t.preventDefault(),t.stopPropagation()})),e(".tpfw-manage_group").length&&(e("input.tpfw-manage_group").on("change",function(t){var a=e(this);a.is(":checked")?a.closest(".tpfw_form_row").removeClass("group-disabled"):a.closest(".tpfw_form_row").addClass("group-disabled"),t.preventDefault()}),e("input.tpfw-manage_group").change())});